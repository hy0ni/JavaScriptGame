#### 💭 호출스택과 이벤트 루프

<br>

##### 백그라운드(타이머, 이벤트 리스너), 
##### 태스크 큐(타이머나 이벤트리스너 콜백함수들)
##### 이벤트 루프(호출스택이 비어있을때 태스크 큐에 있는 이벤트들 하나씩 꺼내주는 역할)
##### 호출 스택(함수들이 실행되는 공간)

<br>

#### 백스라운드: 타이머를 처리하고 이벤트 리스너를 저장하는 공간입니다. setTimeout같은 함수가 실행되면 백스라운드에서 시간을 재고 시간이 되면 setTimeout의 콜백 함수를 태스크 큐로 보냅니다. 또한, addEventListener로 추가한 이벤트를 저장했다가 이벤트가 발생하면 콜백 함수를 태스크 큐로 보냅니다. 백그라운드에서 코드를 실행하는 것이 아니라 실행될 콜백 함수들이 태스크 큐로 들어간다는 것을 기억하세요.

<br>

#### 태스크 큐: 실행되야 할 콜백 함수들이 줄을 서서 대기하고 있는 공간입니다. queue라는 단어가 줄이라는 뜻입니다. 사람들이 가게 앞에 줄을 서면 먼저 선 사람부터 차례로 들어가죠? 태스크 큐도 마찬가지입니다. 태스크 큐에 먼저 들어온 함수부터 실행됩니다. 다만, 태스크 큐도 함수를 직접 실행하지 않습니다. 함수는 모두 호출 스택에서만 실행됩니다. 호출 스택에 들어온 함수가 호출(실행)된다고 생각하면 됩니다. 

<br>

#### 이벤트 루프: 태스크 큐에서 호출 스택으로 함수를 이동시키는 존재가 바로 이벤트 루프 입니다. 호출 스택이 비어 있으면 이벤트 루프는 태스크 큐에서 함수를 하나씩 꺼내(들어온 순서로 꺼내겠죠?) 호출스택으로 옮깁니다. 호출 스택으로 이동한 함수는 그제서야 실행됩니다. 실행이 완료된 함수는 호출 스택에서 빠져나가게 되고, 호출 스택이 비면 이벤트 루프는 태스크 큐에 있는 다음 함수를 호출 스택으로 옮깁니다.

<br>

#### 자바스크립트 엔진은 자바스크립트 소스 코드가 처음 실행되는 순간도 하나의 함수가 실행된다고 봅니다. 크롬은 이를 anonymous라는 함수로 표시합니다.

<br>

##### 다음 코드로 anonymous 함수의 존재를 파악할 수 있습니다.
```javascript
  function a() {
    b();
  }
  function b() {
    console.trace(); // 함수의 호출 스택을 보여주는 메서드 입니다.
  }
  a();
  // anonymous호출 -> a호출 > b호출 ->  console.trace()호출
```

<br>

```javascript
  function aaa() {
    setTimeout(() => {
      console.log('d');
    }, 0);
    console.log('c');
  }

  setTimeout(() => {
    console.log('a');
    aaa();
  }, 0);

  setTimeout(() => {
    aaa();
    console.log('b');
  }, 0);

호출스택: timeraaa0sec
백그라운드:    timeraaa0sec
태스크큐:
콘솔: a c c b d d
```
https://www.zerocho.com/category/JavaScript/post/597f34bbb428530018e8e6e2